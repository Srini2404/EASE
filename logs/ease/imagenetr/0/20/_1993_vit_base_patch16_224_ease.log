2024-10-18 17:39:46,526 [trainer.py] => config: ./exps/ease_inr.json
2024-10-18 17:39:46,534 [trainer.py] => prefix:  
2024-10-18 17:39:46,534 [trainer.py] => dataset: imagenetr
2024-10-18 17:39:46,534 [trainer.py] => memory_size: 0
2024-10-18 17:39:46,534 [trainer.py] => memory_per_class: 0
2024-10-18 17:39:46,534 [trainer.py] => fixed_memory: False
2024-10-18 17:39:46,534 [trainer.py] => shuffle: True
2024-10-18 17:39:46,534 [trainer.py] => init_cls: 20
2024-10-18 17:39:46,535 [trainer.py] => increment: 20
2024-10-18 17:39:46,535 [trainer.py] => model_name: ease
2024-10-18 17:39:46,535 [trainer.py] => backbone_type: vit_base_patch16_224_ease
2024-10-18 17:39:46,535 [trainer.py] => device: [device(type='cuda', index=0)]
2024-10-18 17:39:46,536 [trainer.py] => seed: 1993
2024-10-18 17:39:46,536 [trainer.py] => init_epochs: 20
2024-10-18 17:39:46,536 [trainer.py] => init_lr: 0.05
2024-10-18 17:39:46,536 [trainer.py] => later_epochs: 20
2024-10-18 17:39:46,536 [trainer.py] => later_lr: 0.05
2024-10-18 17:39:46,536 [trainer.py] => batch_size: 16
2024-10-18 17:39:46,537 [trainer.py] => weight_decay: 0.005
2024-10-18 17:39:46,537 [trainer.py] => min_lr: 0
2024-10-18 17:39:46,537 [trainer.py] => optimizer: sgd
2024-10-18 17:39:46,537 [trainer.py] => scheduler: cosine
2024-10-18 17:39:46,537 [trainer.py] => pretrained: True
2024-10-18 17:39:46,537 [trainer.py] => vpt_type: Deep
2024-10-18 17:39:46,537 [trainer.py] => prompt_token_num: 5
2024-10-18 17:39:46,537 [trainer.py] => ffn_num: 64
2024-10-18 17:39:46,537 [trainer.py] => use_diagonal: False
2024-10-18 17:39:46,538 [trainer.py] => recalc_sim: True
2024-10-18 17:39:46,538 [trainer.py] => alpha: 0.1
2024-10-18 17:39:46,538 [trainer.py] => use_init_ptm: False
2024-10-18 17:39:46,538 [trainer.py] => beta: 0
2024-10-18 17:39:46,538 [trainer.py] => use_old_data: False
2024-10-18 17:39:46,538 [trainer.py] => use_reweight: True
2024-10-18 17:39:46,538 [trainer.py] => moni_adam: False
2024-10-18 17:39:46,538 [trainer.py] => adapter_num: -1
2024-10-18 17:40:41,135 [trainer.py] => config: ./exps/ease_inr.json
2024-10-18 17:40:41,135 [trainer.py] => prefix:  
2024-10-18 17:40:41,135 [trainer.py] => dataset: imagenetr
2024-10-18 17:40:41,135 [trainer.py] => memory_size: 0
2024-10-18 17:40:41,135 [trainer.py] => memory_per_class: 0
2024-10-18 17:40:41,135 [trainer.py] => fixed_memory: False
2024-10-18 17:40:41,142 [trainer.py] => shuffle: True
2024-10-18 17:40:41,142 [trainer.py] => init_cls: 20
2024-10-18 17:40:41,142 [trainer.py] => increment: 20
2024-10-18 17:40:41,142 [trainer.py] => model_name: ease
2024-10-18 17:40:41,142 [trainer.py] => backbone_type: vit_base_patch16_224_ease
2024-10-18 17:40:41,142 [trainer.py] => device: [device(type='cuda', index=0)]
2024-10-18 17:40:41,142 [trainer.py] => seed: 1993
2024-10-18 17:40:41,142 [trainer.py] => init_epochs: 20
2024-10-18 17:40:41,142 [trainer.py] => init_lr: 0.05
2024-10-18 17:40:41,142 [trainer.py] => later_epochs: 20
2024-10-18 17:40:41,142 [trainer.py] => later_lr: 0.05
2024-10-18 17:40:41,142 [trainer.py] => batch_size: 16
2024-10-18 17:40:41,142 [trainer.py] => weight_decay: 0.005
2024-10-18 17:40:41,142 [trainer.py] => min_lr: 0
2024-10-18 17:40:41,142 [trainer.py] => optimizer: sgd
2024-10-18 17:40:41,142 [trainer.py] => scheduler: cosine
2024-10-18 17:40:41,142 [trainer.py] => pretrained: True
2024-10-18 17:40:41,142 [trainer.py] => vpt_type: Deep
2024-10-18 17:40:41,142 [trainer.py] => prompt_token_num: 5
2024-10-18 17:40:41,145 [trainer.py] => ffn_num: 64
2024-10-18 17:40:41,145 [trainer.py] => use_diagonal: False
2024-10-18 17:40:41,145 [trainer.py] => recalc_sim: True
2024-10-18 17:40:41,145 [trainer.py] => alpha: 0.1
2024-10-18 17:40:41,146 [trainer.py] => use_init_ptm: False
2024-10-18 17:40:41,147 [trainer.py] => beta: 0
2024-10-18 17:40:41,147 [trainer.py] => use_old_data: False
2024-10-18 17:40:41,147 [trainer.py] => use_reweight: True
2024-10-18 17:40:41,148 [trainer.py] => moni_adam: False
2024-10-18 17:40:41,148 [trainer.py] => adapter_num: -1
2024-10-18 17:40:41,356 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2024-10-18 17:40:44,216 [trainer.py] => All params: 86988288
2024-10-18 17:40:44,217 [trainer.py] => Trainable params: 1189632
2024-10-18 17:40:44,288 [ease.py] => Learning on 0-20
2024-10-18 17:57:25,204 [ease.py] => Task 0, Epoch 20/20 => Loss 0.445, Train_accy 88.59
2024-10-18 17:58:22,744 [ease.py] => Task correct: 100.0
2024-10-18 17:58:22,744 [ease.py] => Task acc: 92.59796806966618
2024-10-18 17:58:22,762 [trainer.py] => No NME accuracy.
2024-10-18 17:58:22,762 [trainer.py] => CNN: {'total': 92.6, '00-19': 92.6, 'old': 0, 'new': 92.6}
2024-10-18 17:58:22,762 [trainer.py] => CNN top1 curve: [92.6]
2024-10-18 17:58:22,762 [trainer.py] => CNN top5 curve: [98.4]

2024-10-18 17:58:22,769 [trainer.py] => Average Accuracy (CNN): 92.6 

2024-10-18 17:58:22,770 [trainer.py] => All params: 87019010
2024-10-18 17:58:22,771 [trainer.py] => Trainable params: 1189632
2024-10-18 17:58:22,773 [ease.py] => Learning on 20-40
2024-10-18 18:14:12,719 [ease.py] => Task 1, Epoch 20/20 => Loss 0.482, Train_accy 87.28
2024-10-18 18:15:52,802 [ease.py] => Task correct: 92.50567751703255
2024-10-18 18:15:52,802 [ease.py] => Task acc: 92.12717638152914
2024-10-18 18:15:52,818 [trainer.py] => No NME accuracy.
2024-10-18 18:15:52,818 [trainer.py] => CNN: {'total': 87.51, '00-19': 86.79, '20-39': 88.29, 'old': 86.79, 'new': 88.29}
2024-10-18 18:15:52,818 [trainer.py] => CNN top1 curve: [92.6, 87.51]
2024-10-18 18:15:52,818 [trainer.py] => CNN top5 curve: [98.4, 97.12]

2024-10-18 18:15:52,818 [trainer.py] => Average Accuracy (CNN): 90.055 

2024-10-18 18:15:52,818 [trainer.py] => All params: 87065090
2024-10-18 18:15:52,818 [trainer.py] => Trainable params: 1189632
2024-10-18 18:15:52,828 [ease.py] => Learning on 40-60
2024-10-18 18:30:46,257 [ease.py] => Task 2, Epoch 20/20 => Loss 0.485, Train_accy 88.01
2024-10-18 18:33:14,740 [ease.py] => Task correct: 90.03632589517385
2024-10-18 18:33:14,740 [ease.py] => Task acc: 92.11209133367929
2024-10-18 18:33:14,754 [trainer.py] => No NME accuracy.
2024-10-18 18:33:14,754 [trainer.py] => CNN: {'total': 85.73, '00-19': 85.63, '20-39': 85.76, '40-59': 85.81, 'old': 85.69, 'new': 85.81}
2024-10-18 18:33:14,764 [trainer.py] => CNN top1 curve: [92.6, 87.51, 85.73]
2024-10-18 18:33:14,764 [trainer.py] => CNN top5 curve: [98.4, 97.12, 95.95]

2024-10-18 18:33:14,764 [trainer.py] => Average Accuracy (CNN): 88.61333333333334 

2024-10-18 18:33:14,764 [trainer.py] => All params: 87141890
2024-10-18 18:33:14,764 [trainer.py] => Trainable params: 1189632
2024-10-18 18:33:14,768 [ease.py] => Learning on 60-80
2024-10-18 18:47:53,809 [ease.py] => Task 3, Epoch 20/20 => Loss 0.491, Train_accy 87.48
2024-10-18 18:51:19,722 [ease.py] => Task correct: 87.10968775020017
2024-10-18 18:51:19,722 [ease.py] => Task acc: 92.19375500400321
2024-10-18 18:51:19,752 [trainer.py] => No NME accuracy.
2024-10-18 18:51:19,752 [trainer.py] => CNN: {'total': 83.43, '00-19': 83.6, '20-39': 83.7, '40-59': 83.0, '60-79': 83.36, 'old': 83.45, 'new': 83.36}
2024-10-18 18:51:19,752 [trainer.py] => CNN top1 curve: [92.6, 87.51, 85.73, 83.43]
2024-10-18 18:51:19,753 [trainer.py] => CNN top5 curve: [98.4, 97.12, 95.95, 95.0]

2024-10-18 18:51:19,753 [trainer.py] => Average Accuracy (CNN): 87.31750000000001 

2024-10-18 18:51:19,754 [trainer.py] => All params: 87249410
2024-10-18 18:51:19,754 [trainer.py] => Trainable params: 1189632
2024-10-18 18:51:19,757 [ease.py] => Learning on 80-100
2024-10-18 19:05:29,753 [ease.py] => Task 4, Epoch 20/20 => Loss 0.489, Train_accy 87.13
2024-10-18 19:09:55,133 [ease.py] => Task correct: 85.05862646566165
2024-10-18 19:09:55,133 [ease.py] => Task acc: 91.92629815745394
2024-10-18 19:09:55,167 [trainer.py] => No NME accuracy.
2024-10-18 19:09:55,167 [trainer.py] => CNN: {'total': 81.54, '00-19': 83.02, '20-39': 82.59, '40-59': 80.86, '60-79': 81.09, '80-99': 79.47, 'old': 81.95, 'new': 79.47}
2024-10-18 19:09:55,167 [trainer.py] => CNN top1 curve: [92.6, 87.51, 85.73, 83.43, 81.54]
2024-10-18 19:09:55,167 [trainer.py] => CNN top5 curve: [98.4, 97.12, 95.95, 95.0, 94.1]

2024-10-18 19:09:55,167 [trainer.py] => Average Accuracy (CNN): 86.162 

2024-10-18 19:09:55,167 [trainer.py] => All params: 87387650
2024-10-18 19:09:55,167 [trainer.py] => Trainable params: 1189632
2024-10-18 19:09:55,167 [ease.py] => Learning on 100-120
2024-10-18 19:26:06,564 [ease.py] => Task 5, Epoch 20/20 => Loss 0.463, Train_accy 87.50
2024-10-18 19:32:06,521 [ease.py] => Task correct: 83.56652949245542
2024-10-18 19:32:06,521 [ease.py] => Task acc: 92.15363511659808
2024-10-18 19:32:06,546 [trainer.py] => No NME accuracy.
2024-10-18 19:32:06,546 [trainer.py] => CNN: {'total': 80.58, '00-19': 80.84, '20-39': 81.33, '40-59': 79.54, '60-79': 77.58, '80-99': 78.64, '100-119': 84.55, 'old': 79.7, 'new': 84.55}
2024-10-18 19:32:06,546 [trainer.py] => CNN top1 curve: [92.6, 87.51, 85.73, 83.43, 81.54, 80.58]
2024-10-18 19:32:06,546 [trainer.py] => CNN top5 curve: [98.4, 97.12, 95.95, 95.0, 94.1, 93.91]

2024-10-18 19:32:06,548 [trainer.py] => Average Accuracy (CNN): 85.23166666666667 

2024-10-18 19:32:06,548 [trainer.py] => All params: 87556610
2024-10-18 19:32:06,549 [trainer.py] => Trainable params: 1189632
2024-10-18 19:32:06,554 [ease.py] => Learning on 120-140
2024-10-18 19:46:05,098 [ease.py] => Task 6, Epoch 20/20 => Loss 0.441, Train_accy 88.61
2024-10-18 19:53:02,950 [ease.py] => Task correct: 82.20218319886094
2024-10-18 19:53:02,950 [ease.py] => Task acc: 92.00284765068818
2024-10-18 19:53:02,981 [trainer.py] => No NME accuracy.
2024-10-18 19:53:02,981 [trainer.py] => CNN: {'total': 79.71, '00-19': 79.97, '20-39': 80.7, '40-59': 78.71, '60-79': 76.88, '80-99': 77.0, '100-119': 83.94, '120-139': 79.61, 'old': 79.73, 'new': 79.61}
2024-10-18 19:53:02,981 [trainer.py] => CNN top1 curve: [92.6, 87.51, 85.73, 83.43, 81.54, 80.58, 79.71]
2024-10-18 19:53:02,981 [trainer.py] => CNN top5 curve: [98.4, 97.12, 95.95, 95.0, 94.1, 93.91, 92.93]

2024-10-18 19:53:02,982 [trainer.py] => Average Accuracy (CNN): 84.44285714285715 

2024-10-18 19:53:02,982 [trainer.py] => All params: 87756290
2024-10-18 19:53:02,983 [trainer.py] => Trainable params: 1189632
2024-10-18 19:53:02,985 [ease.py] => Learning on 140-160
2024-10-18 20:09:50,130 [ease.py] => Task 7, Epoch 20/20 => Loss 0.433, Train_accy 89.38
2024-10-18 20:18:59,670 [ease.py] => Task correct: 81.24620675703014
2024-10-18 20:18:59,670 [ease.py] => Task acc: 92.17074651021647
2024-10-18 20:18:59,689 [trainer.py] => No NME accuracy.
2024-10-18 20:18:59,689 [trainer.py] => CNN: {'total': 79.06, '00-19': 76.92, '20-39': 79.43, '40-59': 78.22, '60-79': 76.71, '80-99': 76.59, '100-119': 82.73, '120-139': 78.38, '140-159': 82.17, 'old': 78.52, 'new': 82.17}
2024-10-18 20:18:59,689 [trainer.py] => CNN top1 curve: [92.6, 87.51, 85.73, 83.43, 81.54, 80.58, 79.71, 79.06]
2024-10-18 20:18:59,699 [trainer.py] => CNN top5 curve: [98.4, 97.12, 95.95, 95.0, 94.1, 93.91, 92.93, 92.58]

2024-10-18 20:18:59,699 [trainer.py] => Average Accuracy (CNN): 83.77000000000001 

2024-10-18 20:18:59,700 [trainer.py] => All params: 87986690
2024-10-18 20:18:59,701 [trainer.py] => Trainable params: 1189632
2024-10-18 20:18:59,711 [ease.py] => Learning on 160-180
2024-10-18 20:32:16,637 [ease.py] => Task 8, Epoch 20/20 => Loss 0.519, Train_accy 86.60
2024-10-18 20:42:10,536 [ease.py] => Task correct: 79.98524257517063
2024-10-18 20:42:10,536 [ease.py] => Task acc: 91.95720346799483
2024-10-18 20:42:10,563 [trainer.py] => No NME accuracy.
2024-10-18 20:42:10,563 [trainer.py] => CNN: {'total': 78.03, '00-19': 75.76, '20-39': 79.11, '40-59': 76.4, '60-79': 75.83, '80-99': 75.36, '100-119': 82.12, '120-139': 77.68, '140-159': 80.93, '160-179': 77.62, 'old': 78.07, 'new': 77.62}
2024-10-18 20:42:10,564 [trainer.py] => CNN top1 curve: [92.6, 87.51, 85.73, 83.43, 81.54, 80.58, 79.71, 79.06, 78.03]
2024-10-18 20:42:10,564 [trainer.py] => CNN top5 curve: [98.4, 97.12, 95.95, 95.0, 94.1, 93.91, 92.93, 92.58, 91.96]

2024-10-18 20:42:10,564 [trainer.py] => Average Accuracy (CNN): 83.13222222222223 

2024-10-18 20:42:10,565 [trainer.py] => All params: 88247810
2024-10-18 20:42:10,566 [trainer.py] => Trainable params: 1189632
2024-10-18 20:42:10,567 [ease.py] => Learning on 180-200
2024-10-18 20:56:47,227 [ease.py] => Task 9, Epoch 20/20 => Loss 0.442, Train_accy 88.81
2024-10-18 21:08:45,197 [ease.py] => Task correct: 78.78333333333333
2024-10-18 21:08:45,197 [ease.py] => Task acc: 92.0
2024-10-18 21:08:45,228 [trainer.py] => No NME accuracy.
2024-10-18 21:08:45,229 [trainer.py] => CNN: {'total': 77.2, '00-19': 75.04, '20-39': 77.22, '40-59': 73.43, '60-79': 75.31, '80-99': 73.92, '100-119': 80.45, '120-139': 76.8, '140-159': 80.25, '160-179': 77.2, '180-199': 81.17, 'old': 76.78, 'new': 81.17}
2024-10-18 21:08:45,229 [trainer.py] => CNN top1 curve: [92.6, 87.51, 85.73, 83.43, 81.54, 80.58, 79.71, 79.06, 78.03, 77.2]
2024-10-18 21:08:45,229 [trainer.py] => CNN top5 curve: [98.4, 97.12, 95.95, 95.0, 94.1, 93.91, 92.93, 92.58, 91.96, 91.53]

2024-10-18 21:08:45,229 [trainer.py] => Average Accuracy (CNN): 82.53900000000002 

