2024-10-18 14:34:32,125 [trainer.py] => config: ./exps/ease_ina.json
2024-10-18 14:34:32,126 [trainer.py] => prefix:  
2024-10-18 14:34:32,126 [trainer.py] => dataset: imageneta
2024-10-18 14:34:32,126 [trainer.py] => memory_size: 0
2024-10-18 14:34:32,126 [trainer.py] => memory_per_class: 0
2024-10-18 14:34:32,126 [trainer.py] => fixed_memory: False
2024-10-18 14:34:32,126 [trainer.py] => shuffle: True
2024-10-18 14:34:32,126 [trainer.py] => init_cls: 20
2024-10-18 14:34:32,126 [trainer.py] => increment: 20
2024-10-18 14:34:32,126 [trainer.py] => model_name: ease
2024-10-18 14:34:32,127 [trainer.py] => backbone_type: vit_base_patch16_224_ease
2024-10-18 14:34:32,128 [trainer.py] => device: [device(type='cuda', index=0)]
2024-10-18 14:34:32,128 [trainer.py] => seed: 1993
2024-10-18 14:34:32,128 [trainer.py] => init_epochs: 20
2024-10-18 14:34:32,128 [trainer.py] => init_lr: 0.05
2024-10-18 14:34:32,128 [trainer.py] => later_epochs: 20
2024-10-18 14:34:32,128 [trainer.py] => later_lr: 0.05
2024-10-18 14:34:32,128 [trainer.py] => batch_size: 32
2024-10-18 14:34:32,128 [trainer.py] => weight_decay: 0.005
2024-10-18 14:34:32,128 [trainer.py] => min_lr: 0
2024-10-18 14:34:32,129 [trainer.py] => optimizer: sgd
2024-10-18 14:34:32,129 [trainer.py] => scheduler: cosine
2024-10-18 14:34:32,129 [trainer.py] => pretrained: True
2024-10-18 14:34:32,129 [trainer.py] => vpt_type: Deep
2024-10-18 14:34:32,129 [trainer.py] => prompt_token_num: 5
2024-10-18 14:34:32,129 [trainer.py] => ffn_num: 64
2024-10-18 14:34:32,129 [trainer.py] => use_diagonal: False
2024-10-18 14:34:32,129 [trainer.py] => recalc_sim: True
2024-10-18 14:34:32,129 [trainer.py] => alpha: 0.1
2024-10-18 14:34:32,130 [trainer.py] => use_init_ptm: False
2024-10-18 14:34:32,130 [trainer.py] => beta: 0
2024-10-18 14:34:32,130 [trainer.py] => use_old_data: False
2024-10-18 14:34:32,130 [trainer.py] => use_reweight: True
2024-10-18 14:34:32,130 [trainer.py] => moni_adam: False
2024-10-18 14:34:32,130 [trainer.py] => adapter_num: -1
2024-10-18 14:36:33,828 [trainer.py] => config: ./exps/ease_ina.json
2024-10-18 14:36:33,828 [trainer.py] => prefix:  
2024-10-18 14:36:33,828 [trainer.py] => dataset: imageneta
2024-10-18 14:36:33,828 [trainer.py] => memory_size: 0
2024-10-18 14:36:33,828 [trainer.py] => memory_per_class: 0
2024-10-18 14:36:33,829 [trainer.py] => fixed_memory: False
2024-10-18 14:36:33,829 [trainer.py] => shuffle: True
2024-10-18 14:36:33,829 [trainer.py] => init_cls: 20
2024-10-18 14:36:33,829 [trainer.py] => increment: 20
2024-10-18 14:36:33,829 [trainer.py] => model_name: ease
2024-10-18 14:36:33,829 [trainer.py] => backbone_type: vit_base_patch16_224_ease
2024-10-18 14:36:33,829 [trainer.py] => device: [device(type='cuda', index=0)]
2024-10-18 14:36:33,830 [trainer.py] => seed: 1993
2024-10-18 14:36:33,830 [trainer.py] => init_epochs: 20
2024-10-18 14:36:33,830 [trainer.py] => init_lr: 0.05
2024-10-18 14:36:33,830 [trainer.py] => later_epochs: 20
2024-10-18 14:36:33,830 [trainer.py] => later_lr: 0.05
2024-10-18 14:36:33,830 [trainer.py] => batch_size: 32
2024-10-18 14:36:33,830 [trainer.py] => weight_decay: 0.005
2024-10-18 14:36:33,830 [trainer.py] => min_lr: 0
2024-10-18 14:36:33,830 [trainer.py] => optimizer: sgd
2024-10-18 14:36:33,831 [trainer.py] => scheduler: cosine
2024-10-18 14:36:33,831 [trainer.py] => pretrained: True
2024-10-18 14:36:33,831 [trainer.py] => vpt_type: Deep
2024-10-18 14:36:33,831 [trainer.py] => prompt_token_num: 5
2024-10-18 14:36:33,831 [trainer.py] => ffn_num: 64
2024-10-18 14:36:33,832 [trainer.py] => use_diagonal: False
2024-10-18 14:36:33,832 [trainer.py] => recalc_sim: True
2024-10-18 14:36:33,832 [trainer.py] => alpha: 0.1
2024-10-18 14:36:33,832 [trainer.py] => use_init_ptm: False
2024-10-18 14:36:33,832 [trainer.py] => beta: 0
2024-10-18 14:36:33,832 [trainer.py] => use_old_data: False
2024-10-18 14:36:33,832 [trainer.py] => use_reweight: True
2024-10-18 14:36:33,832 [trainer.py] => moni_adam: False
2024-10-18 14:36:33,833 [trainer.py] => adapter_num: -1
2024-10-18 14:36:34,059 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2024-10-18 14:36:37,248 [trainer.py] => All params: 86988288
2024-10-18 14:36:37,248 [trainer.py] => Trainable params: 1189632
2024-10-18 14:36:37,319 [ease.py] => Learning on 0-20
2024-10-18 14:45:01,908 [ease.py] => Task 0, Epoch 20/20 => Loss 0.432, Train_accy 91.06
2024-10-18 14:45:41,484 [ease.py] => Task correct: 100.0
2024-10-18 14:45:41,485 [ease.py] => Task acc: 85.14285714285714
2024-10-18 14:45:41,518 [trainer.py] => No NME accuracy.
2024-10-18 14:45:41,518 [trainer.py] => CNN: {'total': 85.14, '00-19': 85.14, 'old': 0, 'new': 85.14}
2024-10-18 14:45:41,519 [trainer.py] => CNN top1 curve: [85.14]
2024-10-18 14:45:41,519 [trainer.py] => CNN top5 curve: [96.57]

2024-10-18 14:45:41,519 [trainer.py] => Average Accuracy (CNN): 85.14 

2024-10-18 14:45:41,520 [trainer.py] => All params: 87019010
2024-10-18 14:45:41,521 [trainer.py] => Trainable params: 1189632
2024-10-18 14:45:41,523 [ease.py] => Learning on 20-40
2024-10-18 14:54:20,030 [ease.py] => Task 1, Epoch 20/20 => Loss 0.549, Train_accy 86.42
2024-10-18 14:55:23,991 [ease.py] => Task correct: 90.83333333333333
2024-10-18 14:55:23,991 [ease.py] => Task acc: 84.72222222222223
2024-10-18 14:55:24,011 [trainer.py] => No NME accuracy.
2024-10-18 14:55:24,011 [trainer.py] => CNN: {'total': 79.44, '00-19': 78.29, '20-39': 80.54, 'old': 78.29, 'new': 80.54}
2024-10-18 14:55:24,011 [trainer.py] => CNN top1 curve: [85.14, 79.44]
2024-10-18 14:55:24,011 [trainer.py] => CNN top5 curve: [96.57, 95.56]

2024-10-18 14:55:24,011 [trainer.py] => Average Accuracy (CNN): 82.28999999999999 

2024-10-18 14:55:24,011 [trainer.py] => All params: 87065090
2024-10-18 14:55:24,011 [trainer.py] => Trainable params: 1189632
2024-10-18 14:55:24,011 [ease.py] => Learning on 40-60
2024-10-18 15:02:58,688 [ease.py] => Task 2, Epoch 20/20 => Loss 0.453, Train_accy 91.39
2024-10-18 15:04:23,650 [ease.py] => Task correct: 83.40336134453781
2024-10-18 15:04:23,650 [ease.py] => Task acc: 84.87394957983193
2024-10-18 15:04:23,660 [trainer.py] => No NME accuracy.
2024-10-18 15:04:23,660 [trainer.py] => CNN: {'total': 74.37, '00-19': 72.57, '20-39': 76.22, '40-59': 74.14, 'old': 74.44, 'new': 74.14}
2024-10-18 15:04:23,660 [trainer.py] => CNN top1 curve: [85.14, 79.44, 74.37]
2024-10-18 15:04:23,660 [trainer.py] => CNN top5 curve: [96.57, 95.56, 94.96]

2024-10-18 15:04:23,670 [trainer.py] => Average Accuracy (CNN): 79.64999999999999 

2024-10-18 15:04:23,670 [trainer.py] => All params: 87141890
2024-10-18 15:04:23,670 [trainer.py] => Trainable params: 1189632
2024-10-18 15:04:23,670 [ease.py] => Learning on 60-80
2024-10-18 15:13:03,044 [ease.py] => Task 3, Epoch 20/20 => Loss 0.470, Train_accy 88.14
2024-10-18 15:15:03,496 [ease.py] => Task correct: 78.36676217765043
2024-10-18 15:15:03,496 [ease.py] => Task acc: 86.24641833810888
2024-10-18 15:15:03,516 [trainer.py] => No NME accuracy.
2024-10-18 15:15:03,516 [trainer.py] => CNN: {'total': 72.06, '00-19': 65.14, '20-39': 72.97, '40-59': 68.1, '60-79': 78.83, 'old': 68.91, 'new': 78.83}
2024-10-18 15:15:03,516 [trainer.py] => CNN top1 curve: [85.14, 79.44, 74.37, 72.06]
2024-10-18 15:15:03,516 [trainer.py] => CNN top5 curve: [96.57, 95.56, 94.96, 92.84]

2024-10-18 15:15:03,516 [trainer.py] => Average Accuracy (CNN): 77.7525 

2024-10-18 15:15:03,516 [trainer.py] => All params: 87249410
2024-10-18 15:15:03,516 [trainer.py] => Trainable params: 1189632
2024-10-18 15:15:03,516 [ease.py] => Learning on 80-100
2024-10-18 15:22:46,657 [ease.py] => Task 4, Epoch 20/20 => Loss 0.432, Train_accy 89.69
2024-10-18 15:25:08,357 [ease.py] => Task correct: 73.12722948870392
2024-10-18 15:25:08,357 [ease.py] => Task acc: 85.73127229488703
2024-10-18 15:25:08,377 [trainer.py] => No NME accuracy.
2024-10-18 15:25:08,377 [trainer.py] => CNN: {'total': 68.85, '00-19': 58.29, '20-39': 71.35, '40-59': 64.66, '60-79': 77.93, '80-99': 67.83, 'old': 69.05, 'new': 67.83}
2024-10-18 15:25:08,377 [trainer.py] => CNN top1 curve: [85.14, 79.44, 74.37, 72.06, 68.85]
2024-10-18 15:25:08,377 [trainer.py] => CNN top5 curve: [96.57, 95.56, 94.96, 92.84, 89.77]

2024-10-18 15:25:08,377 [trainer.py] => Average Accuracy (CNN): 75.97200000000001 

2024-10-18 15:25:08,387 [trainer.py] => All params: 87387650
2024-10-18 15:25:08,387 [trainer.py] => Trainable params: 1189632
2024-10-18 15:25:08,387 [ease.py] => Learning on 100-120
2024-10-18 15:32:47,841 [ease.py] => Task 5, Epoch 20/20 => Loss 0.371, Train_accy 93.12
2024-10-18 15:35:39,272 [ease.py] => Task correct: 70.97435897435898
2024-10-18 15:35:39,272 [ease.py] => Task acc: 86.25641025641026
2024-10-18 15:35:39,292 [trainer.py] => No NME accuracy.
2024-10-18 15:35:39,292 [trainer.py] => CNN: {'total': 67.18, '00-19': 56.57, '20-39': 68.65, '40-59': 63.79, '60-79': 75.23, '80-99': 65.73, '100-119': 70.15, 'old': 66.71, 'new': 70.15}
2024-10-18 15:35:39,292 [trainer.py] => CNN top1 curve: [85.14, 79.44, 74.37, 72.06, 68.85, 67.18]
2024-10-18 15:35:39,292 [trainer.py] => CNN top5 curve: [96.57, 95.56, 94.96, 92.84, 89.77, 87.9]

2024-10-18 15:35:39,292 [trainer.py] => Average Accuracy (CNN): 74.50666666666667 

2024-10-18 15:35:39,292 [trainer.py] => All params: 87556610
2024-10-18 15:35:39,292 [trainer.py] => Trainable params: 1189632
2024-10-18 15:35:39,302 [ease.py] => Learning on 120-140
2024-10-18 15:43:25,358 [ease.py] => Task 6, Epoch 20/20 => Loss 0.535, Train_accy 87.57
2024-10-18 15:46:49,991 [ease.py] => Task correct: 67.35057983942909
2024-10-18 15:46:49,991 [ease.py] => Task acc: 85.72702943800178
2024-10-18 15:46:50,011 [trainer.py] => No NME accuracy.
2024-10-18 15:46:50,011 [trainer.py] => CNN: {'total': 64.05, '00-19': 52.0, '20-39': 68.65, '40-59': 61.21, '60-79': 69.37, '80-99': 65.03, '100-119': 68.66, '120-139': 61.64, 'old': 64.41, 'new': 61.64}
2024-10-18 15:46:50,011 [trainer.py] => CNN top1 curve: [85.14, 79.44, 74.37, 72.06, 68.85, 67.18, 64.05]
2024-10-18 15:46:50,011 [trainer.py] => CNN top5 curve: [96.57, 95.56, 94.96, 92.84, 89.77, 87.9, 86.08]

2024-10-18 15:46:50,011 [trainer.py] => Average Accuracy (CNN): 73.01285714285714 

2024-10-18 15:46:50,011 [trainer.py] => All params: 87756290
2024-10-18 15:46:50,011 [trainer.py] => Trainable params: 1189632
2024-10-18 15:46:50,021 [ease.py] => Learning on 140-160
2024-10-18 15:54:29,894 [ease.py] => Task 7, Epoch 20/20 => Loss 0.496, Train_accy 90.58
2024-10-18 15:58:32,977 [ease.py] => Task correct: 65.5448717948718
2024-10-18 15:58:32,977 [ease.py] => Task acc: 85.09615384615384
2024-10-18 15:58:32,997 [trainer.py] => No NME accuracy.
2024-10-18 15:58:32,997 [trainer.py] => CNN: {'total': 61.94, '00-19': 50.86, '20-39': 66.49, '40-59': 61.21, '60-79': 68.02, '80-99': 64.34, '100-119': 68.66, '120-139': 60.96, '140-159': 51.97, 'old': 63.07, 'new': 51.97}
2024-10-18 15:58:32,997 [trainer.py] => CNN top1 curve: [85.14, 79.44, 74.37, 72.06, 68.85, 67.18, 64.05, 61.94]
2024-10-18 15:58:32,997 [trainer.py] => CNN top5 curve: [96.57, 95.56, 94.96, 92.84, 89.77, 87.9, 86.08, 84.29]

2024-10-18 15:58:32,997 [trainer.py] => Average Accuracy (CNN): 71.62875 

2024-10-18 15:58:33,007 [trainer.py] => All params: 87986690
2024-10-18 15:58:33,007 [trainer.py] => Trainable params: 1189632
2024-10-18 15:58:33,017 [ease.py] => Learning on 160-180
2024-10-18 16:06:27,825 [ease.py] => Task 8, Epoch 20/20 => Loss 0.635, Train_accy 86.87
2024-10-18 16:11:03,378 [ease.py] => Task correct: 62.58064516129032
2024-10-18 16:11:03,378 [ease.py] => Task acc: 84.73118279569893
2024-10-18 16:11:03,398 [trainer.py] => No NME accuracy.
2024-10-18 16:11:03,398 [trainer.py] => CNN: {'total': 59.35, '00-19': 48.57, '20-39': 63.24, '40-59': 55.17, '60-79': 67.57, '80-99': 60.84, '100-119': 67.91, '120-139': 60.96, '140-159': 51.97, '160-179': 53.74, 'old': 60.02, 'new': 53.74}
2024-10-18 16:11:03,398 [trainer.py] => CNN top1 curve: [85.14, 79.44, 74.37, 72.06, 68.85, 67.18, 64.05, 61.94, 59.35]
2024-10-18 16:11:03,398 [trainer.py] => CNN top5 curve: [96.57, 95.56, 94.96, 92.84, 89.77, 87.9, 86.08, 84.29, 82.8]

2024-10-18 16:11:03,398 [trainer.py] => Average Accuracy (CNN): 70.26444444444445 

2024-10-18 16:11:03,398 [trainer.py] => All params: 88247810
2024-10-18 16:11:03,398 [trainer.py] => Trainable params: 1189632
2024-10-18 16:11:03,408 [ease.py] => Learning on 180-200
2024-10-18 16:18:48,567 [ease.py] => Task 9, Epoch 20/20 => Loss 0.434, Train_accy 94.12
2024-10-18 16:24:26,721 [ease.py] => Task correct: 61.81698485845951
2024-10-18 16:24:26,721 [ease.py] => Task acc: 84.52929558920343
2024-10-18 16:24:26,771 [trainer.py] => No NME accuracy.
2024-10-18 16:24:26,771 [trainer.py] => CNN: {'total': 58.85, '00-19': 49.14, '20-39': 61.62, '40-59': 55.17, '60-79': 65.77, '80-99': 60.14, '100-119': 65.67, '120-139': 60.96, '140-159': 51.18, '160-179': 53.06, '180-199': 62.9, 'old': 58.49, 'new': 62.9}
2024-10-18 16:24:26,771 [trainer.py] => CNN top1 curve: [85.14, 79.44, 74.37, 72.06, 68.85, 67.18, 64.05, 61.94, 59.35, 58.85]
2024-10-18 16:24:26,771 [trainer.py] => CNN top5 curve: [96.57, 95.56, 94.96, 92.84, 89.77, 87.9, 86.08, 84.29, 82.8, 81.96]

2024-10-18 16:24:26,771 [trainer.py] => Average Accuracy (CNN): 69.123 

